(()=>{var e={};e.id=391,e.ids=[391],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},33873:e=>{"use strict";e.exports=require("path")},11723:e=>{"use strict";e.exports=require("querystring")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},76603:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>f,tree:()=>c});var r=a(70260),s=a(28203),n=a(25155),i=a.n(n),l=a(67292),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let c=["",{children:["create-test",{children:["[test]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,18207)),"C:\\Users\\rachb\\Downloads\\Telegram Desktop\\kvfNew\\app\\create-test\\[test]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],types:["__DEFAULT__",{},{defaultPage:[()=>Promise.resolve().then(a.t.bind(a,97507,23)),"next/dist/client/components/parallel-route-default.js"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,19611)),"C:\\Users\\rachb\\Downloads\\Telegram Desktop\\kvfNew\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,61129)),"C:\\Users\\rachb\\Downloads\\Telegram Desktop\\kvfNew\\app\\not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\rachb\\Downloads\\Telegram Desktop\\kvfNew\\app\\create-test\\[test]\\page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/create-test/[test]/page",pathname:"/create-test/[test]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8386:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"0073f5af6c1f6ac2579605cfb8d6b91f63e67bd6b0":()=>r.q,"0094d3046b96488141886298814fd70eb4743d5a50":()=>N,"00e98ca86f23c7d86b4de2de658c5682e1cebadae0":()=>u,"00fff6886cf8305264868ff151d9c8b9b52f90be4e":()=>c,"4011922557660c392d56e64daf339b86e4eebbcec7":()=>y,"401717914d5a16ce8635f6ea44e1212d6d2c7d3e05":()=>o,"4049cb5a55d9f00e37b06224b35e194298862b7368":()=>p,"4057d50ba7f574ca4cf249db64cb11d433b9d8e6f4":()=>l,"406a511f9f3af22edff801a8f98c08a31dfa554816":()=>b,"406a727a79373cace5068c19685c15df4d7f5e20fe":()=>g,"4070009e044686020329e3b8cd17c8bcaf3b61dc92":()=>h,"4077a005e744767b30593310e66db752dbae5a41f9":()=>d,"40a511ee6b9ab36d09f8a74b56fee2b8191bc339e3":()=>f,"40b6cbbbfecaa509aab23f5d814a27f8e807325d37":()=>x,"604ead747fdbbc39b22d3a27265a4f6f5461fd2248":()=>m,"60cbae570723b9aa85f8042c3464b764b39e619deb":()=>v,"70947a5b5b8fa09282460237061ca18dba05135380":()=>w});var r=a(40530),s=a(21590);a(70376);var n=a(70709),i=a(8805);async function l(e){try{if(await n.z.user.findFirst({where:{email:e.email}}))return{success:!1};return{success:!!await n.z.user.create({data:{firstName:e.firstName,lastName:e.lastName,surName:e.surName,email:e.email,password:(0,i.hashSync)(e.password,10),startTest:e.startTest,organisation:e.organisation,role:e.role,okAnswers:0,testsResult:"[]"}})}}catch(e){return console.log(e),{success:!1}}}async function o(e){try{return await n.z.user.update({where:{id:e.id},data:{firstName:e.firstName,lastName:e.lastName,email:e.email}}),{edit:!0}}catch(e){return console.error(e),{edit:!1}}}async function c(){try{return await n.z.user.findMany({where:{role:{in:["SCHOOLBOY","STUDENT","SPECIALIST"]}},select:{id:!0,firstName:!0,lastName:!0,surName:!0,email:!0,organisation:!0,role:!0,startTest:!0,testPassed:!0,passedDate:!0,testsResult:!0,okAnswers:!0}})}catch(e){return console.log(e),[]}}async function d(e){try{return await n.z.test.create({data:{category:e.category,name:e.name,nameTranslit:function(e){let t={а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"e",ж:"zh",з:"z",и:"i",й:"y",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"h",ц:"c",ч:"ch",ш:"sh",щ:"sch",ь:"",ы:"y",ъ:"",э:"e",ю:"yu",я:"ya"};e=e.toLowerCase();let a="";for(let r=0;r<e.length;++r)void 0==t[e[r]]?a+=e[r]:a+=t[e[r]];return a=(a=(a=a.replace(/[^-0-9a-z]/g,"-")).replace(/[-]+/g,"-")).replace(/^\-|-$/g,"")}(e.name),text:"[]"}})}catch(e){return e}}async function u(){try{return await n.z.test.findMany({select:{id:!0,name:!0,nameTranslit:!0,category:!0,testDisable:!0}})}catch(e){return console.log(e),[]}}async function f(e){await n.z.test.delete({where:{id:e}})}async function b(e){let t=await n.z.test.findFirst({where:{id:e},select:{testDisable:!0}});console.log(t),t?.testDisable==!0?await n.z.test.update({where:{id:e},data:{testDisable:!1}}):await n.z.test.update({where:{id:e},data:{testDisable:!0}})}async function p(e){try{return await n.z.test.findUnique({where:{id:e}})}catch(e){return console.log(e),[]}}async function m(e,t){try{return await n.z.test.update({where:{id:e},data:{text:JSON.stringify(t)}})}catch(e){return console.log(e),e}}async function h(e){try{return await n.z.test.findUnique({where:{id:e},select:{name:!0}})}catch(e){return console.log(e),[]}}async function x(e){try{return await n.z.test.findUnique({where:{id:e},select:{text:!0}})}catch(e){return console.log(e),[]}}async function g(e){try{return await n.z.test.findMany({where:{category:{in:[e]}},select:{id:!0}})}catch(e){return console.log(e),[]}}async function y(e){try{return await n.z.test.findFirst({where:{nameTranslit:e},select:{name:!0,text:!0}})}catch(e){return console.log(e),e}}async function v(e,t){try{let a=await n.z.user.update({where:{id:e},data:{testPassed:!0,testsResult:t}});return console.log(a),a}catch(e){console.log(e)}}async function w(e,t,a){try{let r=await n.z.user.update({where:{id:e},data:{testPassed:!0,okAnswers:t,passedDate:a}});return console.log(r),r}catch(e){console.log(e)}}async function N(){try{return await n.z.user.findMany({where:{role:{in:["SCHOOLBOY","STUDENT","SPECIALIST"]}},select:{id:!0,firstName:!0,lastName:!0,surName:!0,email:!0,organisation:!0,testPassed:!0,startTest:!0,passedDate:!0,role:!0,testsResult:!0}})}catch(e){throw console.error("Ошибка:",e),Error("Ошибка при получении данных пользователей")}}(0,a(99344).D)([l,o,c,d,u,f,b,p,m,h,x,g,y,v,w,N]),(0,s.A)(l,"4057d50ba7f574ca4cf249db64cb11d433b9d8e6f4",null),(0,s.A)(o,"401717914d5a16ce8635f6ea44e1212d6d2c7d3e05",null),(0,s.A)(c,"00fff6886cf8305264868ff151d9c8b9b52f90be4e",null),(0,s.A)(d,"4077a005e744767b30593310e66db752dbae5a41f9",null),(0,s.A)(u,"00e98ca86f23c7d86b4de2de658c5682e1cebadae0",null),(0,s.A)(f,"40a511ee6b9ab36d09f8a74b56fee2b8191bc339e3",null),(0,s.A)(b,"406a511f9f3af22edff801a8f98c08a31dfa554816",null),(0,s.A)(p,"4049cb5a55d9f00e37b06224b35e194298862b7368",null),(0,s.A)(m,"604ead747fdbbc39b22d3a27265a4f6f5461fd2248",null),(0,s.A)(h,"4070009e044686020329e3b8cd17c8bcaf3b61dc92",null),(0,s.A)(x,"40b6cbbbfecaa509aab23f5d814a27f8e807325d37",null),(0,s.A)(g,"406a727a79373cace5068c19685c15df4d7f5e20fe",null),(0,s.A)(y,"4011922557660c392d56e64daf339b86e4eebbcec7",null),(0,s.A)(v,"60cbae570723b9aa85f8042c3464b764b39e619deb",null),(0,s.A)(w,"70947a5b5b8fa09282460237061ca18dba05135380",null),(0,s.A)(N,"0094d3046b96488141886298814fd70eb4743d5a50",null)},68524:(e,t,a)=>{Promise.resolve().then(a.bind(a,18207))},55372:(e,t,a)=>{Promise.resolve().then(a.bind(a,5297))},5297:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(45512),s=a(58009),n=a(87021),i=a(25409),l=a(47699),o=a(59462);let c=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)("textarea",{className:(0,o.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...t}));c.displayName="Textarea";var d=a(74482),u=a(79334),f=a(26248);f.callServer,f.findSourceMapURL;let b=(0,f.createServerReference)("604ead747fdbbc39b22d3a27265a4f6f5461fd2248",f.callServer,void 0,f.findSourceMapURL,"saveCompletedTest"),p=e=>{let[t,a]=(0,s.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{type:"file",accept:"image/*",onChange:async t=>{let r=t.target.files?.item(0);if(!r)return;if(r.size>5242880)return a(!0);a(!1);let s=await fetch(`/api/upload-test-image/${e.testId}`,{method:"post",headers:{"Content-Type":r.type},body:Buffer.from(await r.arrayBuffer())});if(200!=s.status)return;let n=await s.json();n.url&&e.onChange(n.url)}}),(0,r.jsx)("span",{style:{color:"red",display:t?"block":"none"},children:"Размер файла больше чем пашел нахуй"})]})};function m(){let e=(0,u.useParams)().test;console.log(typeof e);let[t,a]=(0,s.useState)([]),[o,f]=(0,s.useState)(""),[m,h]=(0,s.useState)(["",""]),[x,g]=(0,s.useState)(0),[y,v]=(0,s.useState)(0),[w,N]=(0,s.useState)(""),j=e=>{let t=m.filter((t,a)=>a!==e);h(t),x>=t.length&&g(t.length-1)},C=e=>{(""===o.trim()||m.filter(e=>""!==e.trim()).length<2)&&console.log(e),e>=0?(t.splice(e+1,0,{question:o,options:m.filter(e=>""!==e.trim()),correctAnswer:x,questionScore:y,image:w}),a(t),console.log(t)):a([...t,{question:o,options:m.filter(e=>""!==e.trim()),correctAnswer:x,questionScore:y,image:w}]),f(""),h(["",""]),g(0),N(""),console.log(o)},k=async()=>{await b(Number(e),t).then(()=>{alert("Тест сохранен")})};return(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Конструктор теста"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)(l.J,{htmlFor:"question",children:"Вопрос"}),(0,r.jsx)(c,{id:"question",value:o,onChange:e=>f(e.target.value),className:"mt-1"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)(i.p,{onChange:e=>{v(e.target.value)},className:"flex-grow",type:"number",placeholder:`Сколько баллов даётся за задание`}),(0,r.jsx)(l.J,{children:"Приложить картинку"}),(0,r.jsx)(p,{testId:e,onChange:N}),(0,r.jsx)(l.J,{children:"Варианты ответов"}),m.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center mt-1",children:[(0,r.jsx)(i.p,{value:e,onChange:e=>{let a=[...m];a[t]=e.target.value,h(a),console.log(a)},className:"flex-grow",placeholder:`Вариант ${t+1}`}),(0,r.jsx)(n.$,{onClick:()=>j(t),variant:"destructive",className:"ml-2",disabled:m.length<=2,children:"Удалить"})]},t)),(0,r.jsx)(n.$,{onClick:()=>{h([...m,""])},className:"mt-2",children:"Добавить вариант"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)(l.J,{children:"Правильный ответ"}),(0,r.jsx)(d.z,{value:x.toString(),onValueChange:e=>g(parseInt(e)),children:m.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(d.C,{value:t.toString(),id:`option-${t}`}),(0,r.jsx)(l.J,{htmlFor:`option-${t}`,children:`Вариант ${t+1}`})]},t))})]}),(0,r.jsx)(n.$,{onClick:C,className:"mb-4",children:"Добавить вопрос"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Текущий тест"}),t.map((e,s)=>(0,r.jsxs)("div",{className:"relative p-7 pb-2 pt-6 container mx-auto flex h-full ring-black/5 max-lg:rounded-t-[2rem] my-6 py-10  shadow ring-1 flex-col overflow-hidden rounded-[calc(theme(borderRadius.lg)+1px)] max-lg:rounded-t-[calc(2rem+1px)]",children:[(0,r.jsxs)("p",{children:[(0,r.jsxs)("strong",{children:["В",s+1,":"]})," ",e.question]}),(0,r.jsx)("ul",{className:"list-disc pl-5",children:e.options.map((t,a)=>(0,r.jsxs)("li",{className:a===e.correctAnswer?"font-bold":"",children:[t," ",a===e.correctAnswer&&"(Правильный ответ)"," "]},a))}),(0,r.jsxs)("div",{children:["Колличество баллов:",e.questionScore]}),(0,r.jsxs)("div",{children:["Картинка:",e.image]}),(0,r.jsxs)("div",{className:"flex mt-6",children:[(0,r.jsx)(n.$,{onClick:()=>C(Number(s)),className:" mr-4 mb-4",children:"Добавить вопрос после этого вопроса"}),(0,r.jsx)(n.$,{onClick:()=>{var e;console.log(e=Number(s)),t.splice(e,1),a(t),f(""),h(["",""]),g(0),v(0),N("")},className:" mb-4",children:"Удалить вопрос"})]})]},s))]}),(0,r.jsx)(n.$,{onClick:k,children:"Сохранить тест"})]})}},87021:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(45512),s=a(58009),n=a(12705),i=a(21643),l=a(59462),o=a(6766);let c=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md active:translate-y-[1px] text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-gray-500",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary text-primary bg-transparent hover:bg-secondary",secondary:"bg-secondary text-primary hover:bg-secondary/50",ghost:"hover:bg-secondary hover:text-secondary-foreground",link:"text-primary underline-offset-4 hover:underline",succes:"bg-green-600 text-destructive-foreground hover:bg-destructive/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef(({className:e,variant:t,size:a,asChild:s=!1,children:i,disabled:d,loading:u,...f},b)=>{let p=s?n.DX:"button";return(0,r.jsx)(p,{disabled:d||u,className:(0,l.cn)(c({variant:t,size:a,className:e})),ref:b,...f,children:u?(0,r.jsx)(o.A,{className:"w-5 h-5 animate-spin"}):i})});d.displayName="Button"},25409:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var r=a(45512),s=a(58009),n=a(59462);let i=s.forwardRef(({className:e,type:t,...a},s)=>(0,r.jsx)("input",{type:t,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...a}));i.displayName="Input"},47699:(e,t,a)=>{"use strict";a.d(t,{J:()=>c});var r=a(45512),s=a(58009),n=a(92405),i=a(21643),l=a(59462);let o=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.b,{ref:a,className:(0,l.cn)(o(),e),...t}));c.displayName=n.b.displayName},74482:(e,t,a)=>{"use strict";a.d(t,{C:()=>c,z:()=>o});var r=a(45512),s=a(58009),n=a(94061),i=a(63689),l=a(59462);let o=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.bL,{className:(0,l.cn)("grid gap-2",e),...t,ref:a}));o.displayName=n.bL.displayName;let c=s.forwardRef(({className:e,...t},a)=>(0,r.jsx)(n.q7,{ref:a,className:(0,l.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,r.jsx)(n.C1,{className:"flex  items-center justify-center",children:(0,r.jsx)(i.A,{className:"h-3.5 w-3.5 fill-primary"})})}));c.displayName=n.q7.displayName},18207:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\rachb\\\\Downloads\\\\Telegram Desktop\\\\kvfNew\\\\app\\\\create-test\\\\[test]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\rachb\\Downloads\\Telegram Desktop\\kvfNew\\app\\create-test\\[test]\\page.tsx","default")}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[989,718,750,613,52],()=>a(76603));module.exports=r})();