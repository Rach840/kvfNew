"use strict";exports.id=599,exports.ids=[599],exports.modules={39633:(e,a,t)=>{t.r(a),t.d(a,{"00414c17bf32ff4088f83356756fd1a0d9165a7dad":()=>l,"006323be4ae8d59445d14b87cd7c7f90a04f67c745":()=>N,"0081125577be63c17571a5c16c4a7d7178f760e168":()=>r.q,"00a1032a15a8b3ac64aa43fc299dc6bb91bd0f55b9":()=>f,"4006a1b0dbfa4fa43115cf2461599b6a1c5c9f0f89":()=>d,"400b1b0381486889facd083335794974b871a499c2":()=>g,"40127b2c9ecf36276bd4892393e2940ee9cee9912c":()=>u,"40342318b41ae8eee4c75d75952b41406818acfee4":()=>w,"405bba3e152fc738aaa92c989dbea8e20b47f032c0":()=>m,"4061cc99d9d7f2dcc417745d58bdfe3781928bafb2":()=>i,"406b8f1edd94abc63ea277816b1331d72cba920967":()=>b,"408731cf07c8e982f9311d3ace9a703ad59be64f6b":()=>p,"40c5cf6648f516a3ceb57af9682d1e6bbeafad2e0e":()=>h,"40d3a1d73c3aad617e8e6085d2188e6d2b41e7ca5a":()=>o,"605f79d25e0c67b910fb8c2193d5a188e16a7a6dce":()=>v,"6076c6b25c6da18b09f5ffbfbd7d8fba9d44a4b8f7":()=>y,"703a9a449c86c8428c2d238a7c448b478dc734920c":()=>z});var r=t(40530),s=t(21590);t(70376);var n=t(70709),c=t(8805);async function i(e){try{if(await n.z.user.findFirst({where:{email:e.email}}))return{success:!1};return{success:!!await n.z.user.create({data:{firstName:e.firstName,lastName:e.lastName,surName:e.surName,email:e.email,password:(0,c.hashSync)(e.password,10),startTest:e.startTest,organisation:e.organisation,role:e.role,okAnswers:0,testsResult:"[]"}})}}catch(e){return console.log(e),{success:!1}}}async function d(e){try{return await n.z.user.update({where:{id:e.id},data:{firstName:e.firstName,lastName:e.lastName,email:e.email}}),{edit:!0}}catch(e){return console.error(e),{edit:!1}}}async function l(){try{return await n.z.user.findMany({where:{role:{in:["SCHOOLBOY","STUDENT","SPECIALIST"]}},select:{id:!0,firstName:!0,lastName:!0,surName:!0,email:!0,organisation:!0,role:!0,startTest:!0,testPassed:!0,passedDate:!0,testsResult:!0,okAnswers:!0}})}catch(e){return console.log(e),[]}}async function o(e){try{return await n.z.test.create({data:{category:e.category,name:e.name,nameTranslit:function(e){let a={а:"a",б:"b",в:"v",г:"g",д:"d",е:"e",ё:"e",ж:"zh",з:"z",и:"i",й:"y",к:"k",л:"l",м:"m",н:"n",о:"o",п:"p",р:"r",с:"s",т:"t",у:"u",ф:"f",х:"h",ц:"c",ч:"ch",ш:"sh",щ:"sch",ь:"",ы:"y",ъ:"",э:"e",ю:"yu",я:"ya"};e=e.toLowerCase();let t="";for(let r=0;r<e.length;++r)void 0==a[e[r]]?t+=e[r]:t+=a[e[r]];return t=(t=(t=t.replace(/[^-0-9a-z]/g,"-")).replace(/[-]+/g,"-")).replace(/^\-|-$/g,"")}(e.name),text:"[]"}})}catch(e){return e}}async function f(){try{return await n.z.test.findMany({select:{id:!0,name:!0,nameTranslit:!0,category:!0,testDisable:!0}})}catch(e){return console.log(e),[]}}async function u(e){await n.z.test.delete({where:{id:e}})}async function b(e){let a=await n.z.test.findFirst({where:{id:e},select:{testDisable:!0}});console.log(a),a?.testDisable==!0?await n.z.test.update({where:{id:e},data:{testDisable:!1}}):await n.z.test.update({where:{id:e},data:{testDisable:!0}})}async function m(e){try{return await n.z.test.findUnique({where:{id:e}})}catch(e){return console.log(e),[]}}async function y(e,a){try{return await n.z.test.update({where:{id:e},data:{text:JSON.stringify(a)}})}catch(e){return console.log(e),e}}async function w(e){try{return await n.z.test.findUnique({where:{id:e},select:{name:!0}})}catch(e){return console.log(e),[]}}async function h(e){try{return await n.z.test.findUnique({where:{id:e},select:{text:!0}})}catch(e){return console.log(e),[]}}async function g(e){try{return await n.z.test.findMany({where:{category:{in:[e]}},select:{id:!0}})}catch(e){return console.log(e),[]}}async function p(e){try{return await n.z.test.findFirst({where:{nameTranslit:e},select:{name:!0,text:!0}})}catch(e){return console.log(e),e}}async function v(e,a){try{let t=await n.z.user.update({where:{id:e},data:{testPassed:!0,testsResult:a}});return console.log(t),t}catch(e){console.log(e)}}async function z(e,a,t){try{let r=await n.z.user.update({where:{id:e},data:{testPassed:!0,okAnswers:a,passedDate:t}});return console.log(r),r}catch(e){console.log(e)}}async function N(){try{return await n.z.user.findMany({where:{role:{in:["SCHOOLBOY","STUDENT","SPECIALIST"]}},select:{id:!0,firstName:!0,lastName:!0,surName:!0,email:!0,organisation:!0,testPassed:!0,startTest:!0,passedDate:!0,role:!0,testsResult:!0}})}catch(e){throw console.error("Ошибка:",e),Error("Ошибка при получении данных пользователей")}}(0,t(99344).D)([i,d,l,o,f,u,b,m,y,w,h,g,p,v,z,N]),(0,s.A)(i,"4061cc99d9d7f2dcc417745d58bdfe3781928bafb2",null),(0,s.A)(d,"4006a1b0dbfa4fa43115cf2461599b6a1c5c9f0f89",null),(0,s.A)(l,"00414c17bf32ff4088f83356756fd1a0d9165a7dad",null),(0,s.A)(o,"40d3a1d73c3aad617e8e6085d2188e6d2b41e7ca5a",null),(0,s.A)(f,"00a1032a15a8b3ac64aa43fc299dc6bb91bd0f55b9",null),(0,s.A)(u,"40127b2c9ecf36276bd4892393e2940ee9cee9912c",null),(0,s.A)(b,"406b8f1edd94abc63ea277816b1331d72cba920967",null),(0,s.A)(m,"405bba3e152fc738aaa92c989dbea8e20b47f032c0",null),(0,s.A)(y,"6076c6b25c6da18b09f5ffbfbd7d8fba9d44a4b8f7",null),(0,s.A)(w,"40342318b41ae8eee4c75d75952b41406818acfee4",null),(0,s.A)(h,"40c5cf6648f516a3ceb57af9682d1e6bbeafad2e0e",null),(0,s.A)(g,"400b1b0381486889facd083335794974b871a499c2",null),(0,s.A)(p,"408731cf07c8e982f9311d3ace9a703ad59be64f6b",null),(0,s.A)(v,"605f79d25e0c67b910fb8c2193d5a188e16a7a6dce",null),(0,s.A)(z,"703a9a449c86c8428c2d238a7c448b478dc734920c",null),(0,s.A)(N,"006323be4ae8d59445d14b87cd7c7f90a04f67c745",null)},87021:(e,a,t)=>{t.d(a,{$:()=>o});var r=t(45512),s=t(58009),n=t(12705),c=t(21643),i=t(59462),d=t(6766);let l=(0,c.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md active:translate-y-[1px] text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-gray-500",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary text-primary bg-transparent hover:bg-secondary",secondary:"bg-secondary text-primary hover:bg-secondary/50",ghost:"hover:bg-secondary hover:text-secondary-foreground",link:"text-primary underline-offset-4 hover:underline",succes:"bg-green-600 text-destructive-foreground hover:bg-destructive/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef(({className:e,variant:a,size:t,asChild:s=!1,children:c,disabled:o,loading:f,...u},b)=>{let m=s?n.DX:"button";return(0,r.jsx)(m,{disabled:o||f,className:(0,i.cn)(l({variant:a,size:t,className:e})),ref:b,...u,children:f?(0,r.jsx)(d.A,{className:"w-5 h-5 animate-spin"}):c})});o.displayName="Button"},47699:(e,a,t)=>{t.d(a,{J:()=>l});var r=t(45512),s=t(58009),n=t(92405),c=t(21643),i=t(59462);let d=(0,c.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=s.forwardRef(({className:e,...a},t)=>(0,r.jsx)(n.b,{ref:t,className:(0,i.cn)(d(),e),...a}));l.displayName=n.b.displayName},40530:(e,a,t)=>{t.d(a,{q:()=>o});var r=t(21590);t(70376);var s=t(24118),n=t.n(s),c=t(24871),i=t(70709),d=t(8805);let l={providers:[(0,c.A)({name:"Credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){if(!e)return null;let a={email:e.email},t=await i.z.user.findFirst({where:a});return t&&await (0,d.compare)(e.password,t.password)?{id:t.id,email:t.email,name:t.firstName,role:t.role}:null}})],secret:process.env.NEXTAUTH_SECRET,session:{strategy:"jwt"},callbacks:{async signIn({user:e,account:a}){try{if(a?.provider==="credentials")return!0;if(!e?.email)return!1;return!!await i.z.user.findFirst({where:{email:e.email}})}catch(e){console.log("Error [SIGN IN]",e)}return!1},async jwt({token:e}){if(!e.email)return e;let a=await i.z.user.findFirst({where:{email:e.email}});return a&&(e.id=a.id,e.email=a.email,e.name=a.firstName,e.role=a.role),e},session:({session:e,token:a})=>(e?.user&&(e.user.id=a.id,e.user.role=a.role),e)}};async function o(){let e=await (0,s.getServerSession)(l);if(e?.user)return await i.z.user.findFirst({where:{id:e.user.id}})}n()(l),(0,t(99344).D)([o]),(0,r.A)(o,"0081125577be63c17571a5c16c4a7d7178f760e168",null)},70709:(e,a,t)=>{t.d(a,{z:()=>s});var r=t(96330);let s=globalThis.prismaGlobal??new r.PrismaClient}};