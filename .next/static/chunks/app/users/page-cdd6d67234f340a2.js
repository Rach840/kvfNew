(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9],{3686:()=>{},2383:()=>{},5531:(e,t,r)=>{Promise.resolve().then(r.bind(r,9049))},9049:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(5155),a=r(2115),l=r(5828);let n=(0,l.createServerReference)("00414c17bf32ff4088f83356756fd1a0d9165a7dad",l.callServer,void 0,l.findSourceMapURL,"getAllUsers");var o=r(9184),d=r(4085),i=r(9688),c=r(1615),u=r(7660);async function m(e){let t=u.Wp.book_new(),r=u.Wp.json_to_sheet(e);u.Wp.book_append_sheet(t,r,"Users");let s=u.M9(t,{type:"buffer",bookType:"xlsx"});return new c.NextResponse(s,{status:200,headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":"attachment; filename=users.xlsx"}})}function x(e){let{response:t}=e,[r,l]=(0,a.useState)(!1),n=async()=>{l(!0);try{let e=await m(t),r=await e.blob(),s=window.URL.createObjectURL(r),a=document.createElement("a");a.style.display="none",a.href=s,a.download="users.xlsx",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s)}catch(e){console.error("Ошибка экспортирования пользователей:",e),alert("Ошибка экспортирования пользователей. Повторите попытку.")}finally{l(!1)}};return(0,s.jsx)(d.$,{onClick:n,variant:"outline",className:"bg-green-600 text-white hover:bg-green-700 border-none",title:"Экспортировать пользователей",disabled:r,children:r?"Экспорт...":(0,s.jsx)(i.A,{})})}function g(){let[e,t]=a.useState([]),[r,l]=a.useState([]),[d,i]=a.useState(!1),[c,u]=a.useState(null);return a.useEffect(()=>{(async function(){let e=await n(),r=await n(),s=await (0,o.q)();e.sort((e,t)=>t.okAnswers-e.okAnswers),e.map(e=>e.passedDate=e.passedDate?new Date(Number(e.passedDate)).toLocaleString():"-"),r.map(e=>e.passedDate=new Date(Number(e.passedDate)).toLocaleString()),l(r),t(e),u(s)})()},[]),console.log(e),c&&"ADMIN"===c.role?(0,s.jsxs)("div",{className:"w-12/12 mx-auto mt-3 ",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-t-xl bg-gray-100 py-3 px-3  pt-4",children:[(0,s.jsxs)("div",{className:"block",children:[(0,s.jsxs)("label",{htmlFor:"from",className:"mx-3  text-lg min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","Отсортировать в диапазоне времени от:"]}),(0,s.jsxs)("div",{className:"flex items-end",children:[(0,s.jsx)("input",{type:"date",id:"from",className:" w-full p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"}),(0,s.jsxs)("label",{htmlFor:"from",className:"mx-3  min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","До:"]}),(0,s.jsx)("input",{type:"date",id:"to",className:"mx-3  w-full p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"}),(0,s.jsx)("button",{onClick:()=>{i(!1);let e=document.querySelector("#from").value,s=document.querySelector("#to").value,a=r.filter(t=>{let r=new Date(e).getTime(),a=new Date(s).getTime(),l=function(e){let[t,r]=e.split(", "),[s,a,l]=t.split(".").map(Number),[n,o,d]=r.split(":").map(Number);return new Date(l,a-1,s,n,o,d).getTime()}(t.passedDate);return isNaN(a)?l>=r:isNaN(r)?l<=a:l>=r&&l<=a});0==a.length&&i(!0),l(r),t(a)},type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Отсортировать"})]})]}),(0,s.jsx)("button",{onClick:function(){return i(!1),document.querySelector("#from").value="",document.querySelector("#to").value="",document.querySelector("#search").value="",t(r)},type:"button",className:"mx-3 mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Очистить фильтры"}),(0,s.jsxs)("div",{className:"flex  items-end ",children:[(0,s.jsxs)("div",{className:"block",children:[(0,s.jsxs)("label",{htmlFor:"from",className:"mx-3  min-w-0 grow py-1.5 pl-1 pr-3 text-base text-gray-900 placeholder:text-gray-400 focus:outline focus:outline-0 sm:text-sm/6 p-3",children:[" ","Выберите категорию начального теста"]}),(0,s.jsxs)("select",{defaultValue:"TRAINING",id:"categorysTest",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[(0,s.jsx)("option",{value:"TRAINING",children:"Тренировочный"}),(0,s.jsx)("option",{value:"QUALIFYING",children:"Отборочный"}),(0,s.jsx)("option",{value:"BASIC",children:"Основной"})]})]}),(0,s.jsx)("button",{onClick:function(){i(!1);let e=document.querySelector("#categorysTest").value,s=r.filter(t=>t.startTest==e);return 0==s.length&&i(!0),l(r),t(s)},type:"button",className:"mx-3 mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Найти"}),(0,s.jsxs)("div",{className:"block",children:[(0,s.jsxs)("label",{htmlFor:"from",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white ",children:[" ","Найти пользователей по имени или организация:"," "]}),(0,s.jsx)("input",{id:"search",type:"text",placeholder:"Имя или название организации",className:"block w-full p-2 text-gray-900 border border-gray-300 rounded-lg bg-gray-50 text-base focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),(0,s.jsx)("button",{onClick:function(){i(!1);let s=document.querySelector("#search").value,a=e.filter(e=>e.firstName.toLowerCase().includes(s.toLowerCase())||e.organisation.toLowerCase().includes(s.toLowerCase()));return 0==a.length&&i(!0),l(r),t(a)},type:"button",className:"mx-3 mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Найти"})]})]}),d?(0,s.jsx)("div",{className:"relative bg-white container mx-auto flex h-full ring-black/5 max-lg:rounded-t-[2rem] my-6 py-20 shadow ring-1 flex-col overflow-hidden rounded-[calc(theme(borderRadius.lg)+1px)] max-lg:rounded-t-[calc(2rem+1px)]",children:(0,s.jsx)("h4",{className:"mt-2 text-4xl text-center font-medium tracking-tight text-gray-950 max-lg:text-center",children:"Пользователей с таким параметром нету"})}):(0,s.jsxs)("table",{className:"table-auto w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100",children:[(0,s.jsx)("th",{className:"px-4 py-2",children:"Имя"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Фамилия"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Отчество"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Почта"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Организация"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Специализация"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Уровень начального теста"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Правильных ответов"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Тест пройден"}),(0,s.jsx)("th",{className:"px-4 py-2",children:"Когда пройден"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"bg-white border-b cursor-pointer",children:[(0,s.jsx)("td",{className:"px-4 py-2",children:e.firstName}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.lastName}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.surName}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.email}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.organisation}),(0,s.jsx)("td",{className:"px-4 py-2",children:"SCHOOLBOY"==e.role?"Школьники":"STUDENT"==e.role?"Студенты":"Специалисты"}),(0,s.jsx)("td",{className:"px-4 py-2",children:"TRAINING"==e.startTest?"Тренировочный":"QUALIFYING"==e.startTest?"Отборочный":"Основной"}),(0,s.jsx)("td",{children:e.okAnswers}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.testPassed?"✅":"❌"}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.passedDate?e.passedDate.toLocaleString():"-"})]},e.id))})]}),(0,s.jsxs)("div",{className:"flex flex-1 justify-center mt-10 px-10 max-lg:pb-12 max-lg:pt-10 sm:px-10 lg:pb-12",children:[" ",(0,s.jsx)(x,{response:e})]})]}):(0,s.jsx)("div",{className:"relative bg-white container mx-auto flex h-full ring-black/5 max-lg:rounded-t-[2rem] my-6 py-10 shadow ring-1 flex-col overflow-hidden rounded-[calc(theme(borderRadius.lg)+1px)] max-lg:rounded-t-[calc(2rem+1px)]",children:(0,s.jsx)("div",{className:"px-8 pt-8 sm:px-10 sm:pt-10",children:(0,s.jsx)("h4",{className:"mt-2 text-4xl text-center font-medium tracking-tight text-gray-950 max-lg:text-center",children:"Ошибка, данной страницы не существует"})})})}},4085:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var s=r(5155),a=r(2115),l=r(2317),n=r(1027),o=r(9602),d=r(7594);let i=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md active:translate-y-[1px] text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-gray-500",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary text-primary bg-transparent hover:bg-secondary",secondary:"bg-secondary text-primary hover:bg-secondary/50",ghost:"hover:bg-secondary hover:text-secondary-foreground",link:"text-primary underline-offset-4 hover:underline",succes:"bg-green-600 text-destructive-foreground hover:bg-destructive/90"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:n,asChild:c=!1,children:u,disabled:m,loading:x,...g}=e,p=c?l.DX:"button";return(0,s.jsx)(p,{disabled:m||x,className:(0,o.cn)(i({variant:a,size:n,className:r})),ref:t,...g,children:x?(0,s.jsx)(d.A,{className:"w-5 h-5 animate-spin"}):u})});c.displayName="Button"},9602:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var s=r(3463),a=r(9795);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},9184:(e,t,r)=>{"use strict";r.d(t,{q:()=>a});var s=r(5828);let a=(0,s.createServerReference)("0081125577be63c17571a5c16c4a7d7178f760e168",s.callServer,void 0,s.findSourceMapURL,"getUserSession")}},e=>{var t=t=>e(e.s=t);e.O(0,[524,525,86,441,517,358],()=>t(5531)),_N_E=e.O()}]);